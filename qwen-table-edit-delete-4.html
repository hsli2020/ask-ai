<!--

æ·»åŠ ä»¥ä¸‹åŠŸèƒ½
    å¯¼å‡ºä¸º CSV
    åˆ†é¡µåŠŸèƒ½
    å¤šå­—æ®µæ’åº
    å…¬å¸åä¹Ÿæ”¯æŒæ‹¼éŸ³æœç´¢
    å“åº”å¼é€‚é…æ‰‹æœº

Qwen3-235B-A22B-2507 4:21 pm

å¤ªæ£’äº†ï¼ä»¥ä¸‹æ˜¯ç»ˆæå¢å¼ºç‰ˆå¯ç¼–è¾‘è¡¨æ ¼ï¼ŒåŒ…å«ä½ è¦æ±‚çš„å…¨éƒ¨åŠŸèƒ½ï¼š 
 
âœ… æ–°å¢åŠŸèƒ½ 
âœ… å¯¼å‡ºä¸º CSV		ç‚¹å‡»æŒ‰é’®å¯¼å‡ºå½“å‰æ•°æ®ï¼ˆå«æœç´¢ç»“æœï¼‰
âœ… åˆ†é¡µåŠŸèƒ½			æ¯é¡µæ˜¾ç¤º 5 æ¡ï¼Œæ”¯æŒä¸Šä¸€é¡µ/ä¸‹ä¸€é¡µ
âœ… å¤šå­—æ®µæ’åº		ç‚¹å‡»è¡¨å¤´æŒ‰å§“åã€é‚®ç®±ã€å…¬å¸ã€ç”Ÿæ—¥æ’åºï¼ˆå‡åº/é™åºï¼‰
âœ… å…¬å¸åæ‹¼éŸ³æœç´¢		å…¬å¸å­—æ®µä¹Ÿæ”¯æŒæ‹¼éŸ³åŒ¹é…
âœ… å“åº”å¼é€‚é…æ‰‹æœº		è¡¨æ ¼å¯æ¨ªå‘æ»šåŠ¨ï¼ŒæŒ‰é’®é€‚é…å°å±
âœ… æŒä¹…åŒ– + é«˜äº® + æ·»åŠ /ç¼–è¾‘/åˆ é™¤	ä¿ç•™ä¹‹å‰æ‰€æœ‰åŠŸèƒ½
 
âœ… å®Œæ•´ä»£ç ï¼ˆå¤åˆ¶ç²˜è´´å³å¯è¿è¡Œï¼‰

-->

<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ç»ˆæç‰ˆç”¨æˆ·ç®¡ç†ç³»ç»Ÿ</title>
  <!-- script src="https://cdn.jsdelivr.net/npm/pinyin-pro@2.20.0/dist/pinyin.min.js"></script -->
  <script src="https://cdn.jsdelivr.net/npm/pinyin@4.0.0/lib/umd/pinyin.min.js"></script>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 15px;
      background-color: #f9f9f9;
      color: #333;
    }
    h2 {
      color: #2c3e50;
    }

    /* å“åº”å¼å®¹å™¨ */
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    /* æœç´¢ + æŒ‰é’®è¡Œ */
    .header {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
      align-items: center;
    }
    .search-container {
      flex: 1;
      min-width: 200px;
    }
    .search-container label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      font-size: 14px;
    }
    #searchInput {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 16px;
    }

    .actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    button {
      padding: 10px 15px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }
    #addUserBtn {
      background-color: #4CAF50;
      color: white;
    }
    #exportBtn {
      background-color: #2196F3;
      color: white;
    }

    /* è¡¨æ ¼å“åº”å¼åŒ…è£… */
    .table-responsive {
      overflow-x: auto;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      padding: 12px 10px;
      text-align: center;
      border-bottom: 1px solid #eee;
    }
    th {
      background-color: #3498db;
      color: white;
      cursor: pointer;
      user-select: none;
      position: relative;
    }
    th:hover {
      background-color: #2980b9;
    }
    .sort-icon {
      font-size: 10px;
      margin-left: 5px;
    }
    .highlight {
      background-color: #fffacd;
      padding: 2px 4px;
      border-radius: 3px;
    }
    .action-btn {
      margin: 0 3px;
      padding: 5px 8px;
      font-size: 13px;
    }
    .edit-btn {
      background-color: #3498db;
      color: white;
    }
    .delete-btn {
      background-color: #e74c3c;
      color: white;
    }

    /* åˆ†é¡µ */
    .pagination {
      margin-top: 20px;
      text-align: center;
      font-size: 14px;
    }
    .pagination button {
      margin: 0 5px;
      padding: 8px 12px;
      background: #f1f1f1;
      border: 1px solid #ddd;
    }
    .pagination button:disabled {
      color: #aaa;
      background: #f9f9f9;
    }
    .pagination button:not(:disabled):hover {
      background: #ddd;
    }

    /* å¯¹è¯æ¡† */
    dialog {
      border: none;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.2);
      padding: 0;
      width: 90%;
      max-width: 500px;
    }
    dialog .dialog-header {
      background: #2c3e50;
      color: white;
      padding: 15px 20px;
      margin: 0;
    }
    dialog .dialog-body {
      padding: 20px;
    }
    .form-group {
      margin-bottom: 15px;
    }
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #555;
    }
    .form-group input, .form-group select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .dialog-buttons {
      text-align: right;
      margin-top: 20px;
    }
    .dialog-buttons button {
      padding: 8px 15px;
      margin-left: 10px;
    }
    .save-btn {
      background-color: #27ae60;
      color: white;
    }
    .cancel-btn {
      background-color: #95a5a6;
      color: white;
    }

    @media (max-width: 600px) {
      .header {
        flex-direction: column;
        align-items: stretch;
      }
      .actions {
        justify-content: center;
      }
      th, td {
        padding: 8px 6px;
        font-size: 14px;
      }
      button {
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
<div class="container">

  <h2>ç”¨æˆ·ä¿¡æ¯ç®¡ç†ç³»ç»Ÿ</h2>

  <div class="header">
    <div class="search-container">
      <label for="searchInput">ğŸ” æœç´¢å§“å/é‚®ç®±/å…¬å¸/æ‹¼éŸ³</label>
      <input type="text" id="searchInput" placeholder="è¾“å…¥å…³é”®å­—..." />
    </div>
    <div class="actions">
      <button id="addUserBtn">â• æ·»åŠ ç”¨æˆ·</button>
      <button id="exportBtn">ğŸ“¤ å¯¼å‡º CSV</button>
    </div>
  </div>

  <div class="table-responsive">
    <table id="dataTable">
      <thead>
        <tr>
          <th data-sort="id">ID <span class="sort-icon"></span></th>
          <th data-sort="name">å§“å <span class="sort-icon"></span></th>
          <th data-sort="email">é‚®ç®± <span class="sort-icon"></span></th>
          <th data-sort="company">å…¬å¸ <span class="sort-icon"></span></th>
          <th data-sort="birthday">ç”Ÿæ—¥ <span class="sort-icon"></span></th>
          <th>æ“ä½œ</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
  </div>

  <div class="pagination" id="pagination">
    <button id="prevBtn" disabled>ä¸Šä¸€é¡µ</button>
    <span id="pageInfo">ç¬¬ 1 é¡µ</span>
    <button id="nextBtn">ä¸‹ä¸€é¡µ</button>
  </div>

</div>

<!-- ç¼–è¾‘/æ·»åŠ å¯¹è¯æ¡† -->
<dialog id="editDialog">
  <div class="dialog-header">
    <h2 id="dialogTitle">ç¼–è¾‘ç”¨æˆ·</h2>
  </div>
  <div class="dialog-body">
    <form id="editForm">
      <input type="hidden" id="edit-id" />
      <div class="form-group">
        <label for="edit-name">å§“å</label>
        <input type="text" id="edit-name" required />
      </div>
      <div class="form-group">
        <label for="edit-email">é‚®ç®±</label>
        <input type="email" id="edit-email" required />
      </div>
      <div class="form-group">
        <label for="edit-company">å…¬å¸</label>
        <input type="text" id="edit-company" required />
      </div>
      <div class="form-group">
        <label for="edit-birthday">ç”Ÿæ—¥</label>
        <input type="date" id="edit-birthday" required />
      </div>
      <div class="dialog-buttons">
        <button type="button" class="cancel-btn" id="cancelBtn">å–æ¶ˆ</button>
        <button type="submit" class="save-btn">ä¿å­˜</button>
      </div>
    </form>
  </div>
</dialog>

<script>
  // åŠ è½½æ•°æ®
  const loadData = () => {
    const saved = localStorage.getItem("tableData");
    return saved ? JSON.parse(saved) : [
      { id: 1, name: "å¼ ä¸‰", email: "zhangsan@example.com", company: "ç§‘æŠ€å…¬å¸", birthday: "1990-01-15" },
      { id: 2, name: "æå››", email: "lisi@company.com", company: "è®¾è®¡å·¥ä½œå®¤", birthday: "1985-03-22" },
      { id: 3, name: "ç‹äº”", email: "wangwu@gmail.com", company: "è°·æ­Œ", birthday: "1992-07-10" },
      { id: 4, name: "èµµå…­", email: "zhaoliu@hotmail.com", company: "å¾®è½¯", birthday: "1988-11-05" },
      { id: 5, name: "é™ˆä¸ƒ", email: "chenqi@outlook.com", company: "åˆåˆ›å…¬å¸", birthday: "1995-04-18" },
      { id: 6, name: "åˆ˜å…«", email: "liuba@tech.org", company: "TechCorp", birthday: "1991-09-30" },
      { id: 7, name: "å­™ä¹", email: "sunjiu@data.net", company: "æ•°æ®å…¬å¸", birthday: "1987-12-25" },
      { id: 8, name: "å‘¨å", email: "zhoushi@web.cn", company: "ç½‘ç»œå…¬å¸", birthday: "1993-06-14" },
      { id: 9, name: "å´å°æ˜", email: "wuxiaoming@abc.com", company: "ABCé›†å›¢", birthday: "1990-08-09" },
      { id: 10, name: "éƒ‘å¤§ä¼Ÿ", email: "zhengdawei@xyz.com", company: "XYZç§‘æŠ€", birthday: "1984-02-28" },
      { id: 11, name: "é»„ä¸½ä¸½", email: "huanglili@demo.com", company: "Demoå…¬å¸", birthday: "1996-05-12" },
      { id: 12, name: "å¾é£", email: "xufei@startup.io", company: "StartupLab", birthday: "1994-10-03" }
    ];
  };

  let tableData = loadData();
  let filteredData = [];
  let currentPage = 1;
  const pageSize = 5;
  let isAddingNew = false;
  let sortConfig = { key: 'id', direction: 'asc' };

  const tableBody = document.getElementById("tableBody");
  const searchInput = document.getElementById("searchInput");
  const dialog = document.getElementById("editDialog");
  const editForm = document.getElementById("editForm");
  const cancelBtn = document.getElementById("cancelBtn");
  const addUserBtn = document.getElementById("addUserBtn");
  const exportBtn = document.getElementById("exportBtn");
  const prevBtn = document.getElementById("prevBtn");
  const nextBtn = document.getElementById("nextBtn");
  const pageInfo = document.getElementById("pageInfo");
  const dialogTitle = document.getElementById("dialogTitle");

  function saveData() {
    localStorage.setItem("tableData", JSON.stringify(tableData));
  }

  function highlightText(text, query) {
    if (!query) return text;
    const regex = new RegExp(`(${query})`, 'gi');
    return text.toString().replace(regex, '<span class="highlight">$1</span>');
  }

  async function getPinyin(text) {
    try {
      return pinyin(text, { toneType: 'none', type: 'array' }).join(' ').toLowerCase();
    } catch (e) {
      return '';
    }
  }

  async function applyFilterAndSort() {
    const query = searchInput.value.trim().toLowerCase();
    let data = [...tableData];

    if (query) {
      const pinyinPromises = data.map(async item => ({
        id: item.id,
        namePinyin: await getPinyin(item.name),
        companyPinyin: await getPinyin(item.company)
      }));
      const pinyinResults = await Promise.all(pinyinPromises);
      const map = pinyinResults.reduce((acc, r) => {
        acc[r.id] = r;
        return acc;
      }, {});

      data = data.filter(item => {
        const p = map[item.id];
        return (
          item.name.toLowerCase().includes(query) ||
          item.email.toLowerCase().includes(query) ||
          item.company.toLowerCase().includes(query) ||
          p.namePinyin.includes(query) ||
          p.companyPinyin.includes(query)
        );
      });
    }

    // æ’åº
    data.sort((a, b) => {
      let aValue = a[sortConfig.key];
      let bValue = b[sortConfig.key];

      if (sortConfig.key === 'birthday') {
        aValue = new Date(aValue);
        bValue = new Date(bValue);
      }

      if (aValue < bValue) return sortConfig.direction === 'asc' ? -1 : 1;
      if (aValue > bValue) return sortConfig.direction === 'asc' ? 1 : -1;
      return 0;
    });

    filteredData = data;
    currentPage = 1;
    renderTable();
    updatePagination();
  }

  function renderTable() {
    const start = (currentPage - 1) * pageSize;
    const pageData = filteredData.slice(start, start + pageSize);
    const query = searchInput.value.trim();

    tableBody.innerHTML = "";
    pageData.forEach(user => {
      let name = user.name;
      let email = user.email;
      let company = user.company;

      if (query) {
        name = highlightText(user.name, query);
        email = highlightText(user.email, query);
        company = highlightText(user.company, query);
      }

      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${user.id}</td>
        <td>${name}</td>
        <td>${email}</td>
        <td>${company}</td>
        <td>${user.birthday}</td>
        <td>
          <button class="action-btn edit-btn" data-id="${user.id}">Edit</button>
          <button class="action-btn delete-btn" data-id="${user.id}">Delete</button>
        </td>
      `;
      tableBody.appendChild(tr);
    });

    bindEvents();
  }

  function updatePagination() {
    const totalPages = Math.ceil(filteredData.length / pageSize);
    prevBtn.disabled = currentPage === 1;
    nextBtn.disabled = currentPage >= totalPages;
    pageInfo.textContent = `ç¬¬ ${currentPage} é¡µï¼Œå…± ${totalPages} é¡µ`;
  }

  function bindEvents() {
    document.querySelectorAll(".delete-btn").forEach(btn => {
      btn.addEventListener("click", function () {
        const id = parseInt(this.getAttribute("data-id"));
        tableData = tableData.filter(u => u.id !== id);
        saveData();
        applyFilterAndSort();
      });
    });

    document.querySelectorAll(".edit-btn").forEach(btn => {
      btn.addEventListener("click", function () {
        const id = parseInt(this.getAttribute("data-id"));
        const user = tableData.find(u => u.id === id);
        if (user) {
          isAddingNew = false;
          dialogTitle.textContent = "ç¼–è¾‘ç”¨æˆ·";
          document.getElementById("edit-id").value = user.id;
          document.getElementById("edit-name").value = user.name;
          document.getElementById("edit-email").value = user.email;
          document.getElementById("edit-company").value = user.company;
          document.getElementById("edit-birthday").value = user.birthday;
          dialog.showModal();
        }
      });
    });
  }

  // æ’åº
  document.querySelectorAll("th[data-sort]").forEach(th => {
    th.addEventListener("click", () => {
      const key = th.getAttribute("data-sort");
      if (sortConfig.key === key) {
        sortConfig.direction = sortConfig.direction === 'asc' ? 'desc' : 'asc';
      } else {
        sortConfig.key = key;
        sortConfig.direction = 'asc';
      }
      // æ›´æ–°å›¾æ ‡
      document.querySelectorAll(".sort-icon").forEach(el => el.textContent = '');
      const icon = th.querySelector(".sort-icon");
      icon.textContent = sortConfig.direction === 'asc' ? 'â†‘' : 'â†“';
      applyFilterAndSort();
    });
  });

  // åˆ†é¡µ
  prevBtn.addEventListener("click", () => {
    if (currentPage > 1) {
      currentPage--;
      renderTable();
      updatePagination();
    }
  });
  nextBtn.addEventListener("click", () => {
    const totalPages = Math.ceil(filteredData.length / pageSize);
    if (currentPage < totalPages) {
      currentPage++;
      renderTable();
      updatePagination();
    }
  });

  // æ·»åŠ ç”¨æˆ·
  addUserBtn.addEventListener("click", () => {
    isAddingNew = true;
    dialogTitle.textContent = "æ·»åŠ ç”¨æˆ·";
    editForm.reset();
    document.getElementById("edit-id").value = "";
    dialog.showModal();
  });

  // å¯¼å‡º CSV
  exportBtn.addEventListener("click", async () => {
    await applyFilterAndSort(); // ç¡®ä¿æ‹¼éŸ³å·²åŠ è½½
    const header = ['ID', 'å§“å', 'é‚®ç®±', 'å…¬å¸', 'ç”Ÿæ—¥'];
    const csv = [
      header.join(','),
      ...filteredData.map(u => [
        u.id,
        `"${u.name}"`,
        `"${u.email}"`,
        `"${u.company}"`,
        `"${u.birthday}"`
      ].join(','))
    ].join('\n');

    const blob = new Blob([`\uFEFF${csv}`], { type: 'text/csv;charset=utf-8;' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = `ç”¨æˆ·æ•°æ®_${new Date().toLocaleDateString()}.csv`;
    a.click();
    URL.revokeObjectURL(url);
  });

  // è¡¨å•æäº¤
  editForm.addEventListener("submit", function (e) {
    e.preventDefault();
    const name = document.getElementById("edit-name").value.trim();
    const email = document.getElementById("edit-email").value.trim();
    const company = document.getElementById("edit-company").value.trim();
    const birthday = document.getElementById("edit-birthday").value;

    if (isAddingNew) {
      const maxId = tableData.length > 0 ? Math.max(...tableData.map(u => u.id)) : 0;
      tableData.push({ id: maxId + 1, name, email, company, birthday });
    } else {
      const id = parseInt(document.getElementById("edit-id").value);
      const user = tableData.find(u => u.id === id);
      if (user) {
        Object.assign(user, { name, email, company, birthday });
      }
    }

    saveData();
    dialog.close();
    applyFilterAndSort();
  });

  cancelBtn.addEventListener("click", () => {
    dialog.close();
  });

  // åˆå§‹åŒ–
  (async () => {
    await applyFilterAndSort();
  })();
</script>

</body>
</html>

<!--

âœ… åŠŸèƒ½æµ‹è¯•å»ºè®® 
ğŸ“± å“åº”å¼			ç¼©å°æµè§ˆå™¨çª—å£ï¼Œè§‚å¯Ÿå¸ƒå±€è‡ªé€‚åº”
ğŸ”¤ æ‹¼éŸ³æœç´¢		è¾“å…¥zhangâ†’ åŒ¹é…â€œå¼ ä¸‰â€ï¼Œè¾“å…¥qichuangâ†’ åŒ¹é…â€œåˆåˆ›å…¬å¸â€
ğŸ“Š åˆ†é¡µ			æœç´¢åçœ‹åˆ†é¡µæ˜¯å¦åŠ¨æ€æ›´æ–°
ğŸ”½ æ’åº			ç‚¹å‡»â€œå§“åâ€ä¸¤æ¬¡ï¼šå‡åº â†’ é™åº
ğŸ’¾ æŒä¹…åŒ–		åˆ·æ–°é¡µé¢ï¼Œæ•°æ®ä»åœ¨
ğŸ“¤ å¯¼å‡º CSV		ä¸‹è½½åç”¨ Excel æ‰“å¼€ï¼Œä¸­æ–‡æ­£å¸¸
 
ğŸ‰ æ€»ç»“ 

è¿™ä¸ªè¡¨æ ¼å·²å…·å¤‡ï¼š 

    âœ… å®Œæ•´çš„ CRUD æ“ä½œ
    âœ… å®æ—¶ æœç´¢ + æ‹¼éŸ³æ”¯æŒ
    âœ… é«˜äº® åŒ¹é…é¡¹
    âœ… åˆ†é¡µ æ§åˆ¶
    âœ… å¤šå­—æ®µæ’åº
    âœ… å¯¼å‡º CSV
    âœ… å“åº”å¼è®¾è®¡
    âœ… æ•°æ®æŒä¹…åŒ–
     
å¦‚éœ€è¿›ä¸€æ­¥å‡çº§ï¼Œå¯è€ƒè™‘ï¼š 

    ğŸ” ç”¨æˆ·ç™»å½•ä¿æŠ¤
    ğŸ“… æ—¥å†è§†å›¾ç”Ÿæ—¥æé†’
    ğŸ“Š æ•°æ®ç»Ÿè®¡å›¾è¡¨
    ğŸ” é«˜çº§ç­›é€‰ï¼ˆæ—¥æœŸèŒƒå›´ã€å…¬å¸åˆ†ç±»ï¼‰
     

éœ€è¦æˆ‘ç»§ç»­æ‰©å±•å—ï¼Ÿæ¬¢è¿æå‡ºï¼ 

-->