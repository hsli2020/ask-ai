<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>WMS · Shell</title>
<style>
  /* Bright, large-type UI */
  :root{
    --bg:#f8fafc; --panel:#ffffff; --text:#0b1223; --muted:#334155;
    --accent:#2563eb; --accent-weak:#e2e8f0; --border:#e5e7eb;
    --hover:#f1f5f9; --chip:#eef2ff; --mark:#fde68a; --shadow: 0 10px 28px rgba(2,6,23,.08);
  }
  [data-theme="dark"]{
    --bg:#0f172a; --panel:#111827; --text:#e5e7eb; --muted:#9ca3af;
    --accent:#60a5fa; --accent-weak:#1e293b; --border:#1f2937;
    --hover:#0b1223; --chip:#0b1b36; --mark:#fde68a; --shadow: 0 10px 28px rgba(0,0,0,.35);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0; font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial; color:var(--text); background:var(--bg)}

  .layout{
    height:100vh; display:grid; grid-template-columns: 380px 1fr; gap:0;
  }
  .sidebar{
    height:100%; overflow:auto; padding:16px; background:var(--bg); border-right:1px solid var(--border);
  }
  .content{
    height:100%; background:#fff; /* iframe pane background */
  }
  .content iframe{
    width:100%; height:100%; border:0; background:#fff;
  }

  /* Menu block (from the new UI you asked for) */
  header{
    display:flex; align-items:center; justify-content:space-between;
    padding: 12px 14px; background: var(--panel); border:1px solid var(--border);
    border-radius:16px; box-shadow: var(--shadow); margin-bottom:14px;
  }
  .brand{display:flex; gap:10px; align-items:center; font-weight:800; letter-spacing:.2px; font-size:18px}
  .brand svg{width:20px;height:20px}
  .btn{border:1px solid var(--border); background:linear-gradient(180deg, var(--panel), var(--accent-weak)); color:var(--text); padding:8px 12px; border-radius:12px; cursor:pointer; font-size:15px}
  .btn:hover{background:var(--hover)}

  .search{display:flex; gap:10px; align-items:center; padding:10px 12px; background:var(--panel); border:1px solid var(--border); border-radius:14px; box-shadow:var(--shadow); margin-bottom:12px}
  .search input{flex:1; border:0; outline:0; background:transparent; color:var(--text); font-size:16px}
  .kbd{font-size:13px; color:var(--muted); border:1px solid var(--border); padding:3px 7px; border-radius:9px; background:var(--accent-weak)}

  .quick{display:flex; gap:10px; flex-wrap:wrap; margin-bottom:12px}
  .chip{display:inline-flex; align-items:center; gap:10px; padding:10px 12px; border-radius:12px; text-decoration:none; background:var(--chip); color:var(--text); border:1px solid var(--border); font-size:15px}
  .chip:hover{background:var(--hover)}
  .chip svg{width:18px;height:18px}

  .groups{display:flex; flex-direction:column; gap:12px; padding-bottom:12px}
  details.group{border:1px solid var(--border); border-radius:16px; background:var(--panel); box-shadow:var(--shadow)}
  details.group > summary{list-style:none; cursor:pointer; padding:12px 14px; user-select:none; display:flex; align-items:center; gap:10px; font-weight:700}
  details.group > summary::-webkit-details-marker{display:none}
  .menu{margin:0; padding:8px 8px 12px 8px; list-style:none; border-top:1px dashed var(--border)}
  .menu li{margin:3px 0}
  .menu a{display:flex; align-items:center; gap:12px; text-decoration:none; color:var(--text); padding:10px 12px; border-radius:12px; border:1px solid transparent; font-size:16px}
  .menu a:hover{background:var(--hover); border-color:var(--border)}
  .menu a[aria-current="page"]{
    background: color-mix(in oklab, var(--accent) 18%, transparent);
    border-color: color-mix(in oklab, var(--accent) 40%, var(--border));
    outline: 2px solid color-mix(in oklab, var(--accent) 40%, transparent);
  }
  .submenu{ padding-left:28px; margin-top:6px; border-left:2px dashed var(--border) }

  a:focus-visible, button:focus-visible, input:focus-visible, summary:focus-visible{
    outline:3px solid color-mix(in oklab, var(--accent) 70%, transparent); outline-offset:2px; border-radius:12px;
  }
</style>

<!-- icons -->
<svg width="0" height="0" style="position:absolute"><defs>
  <symbol id="ic-box" viewBox="0 0 24 24"><path fill="currentColor" d="m21 8l-9 5l-9-5l9-5zM3 10l9 5l9-5v8l-9 5l-9-5z"/></symbol>
  <symbol id="ic-home" viewBox="0 0 24 24"><path fill="currentColor" d="M12 3 3 10h2v10h6V14h2v6h6V10h2z"/></symbol>
  <symbol id="ic-scan" viewBox="0 0 24 24"><path fill="currentColor" d="M4 7V4h3v2H6v1H4zm14 0V6h-1V4h3v3h-2zM4 20v-3h2v1h1v2H4zm14 0h-3v-2h1v-1h2v3zM6 10h12v4H6z"/></symbol>
  <symbol id="ic-truck" viewBox="0 0 24 24"><path fill="currentColor" d="M3 7h11v9H3zM14 10h3l3 3v3h-6zM6.5 20a1.5 1.5 0 1 1 0-3a1.5 1.5 0 0 1 0 3m9 0a1.5 1.5 0 1 1 0-3a1.5 1.5 0 0 1 0 3"/></symbol>
  <symbol id="ic-broom" viewBox="0 0 24 24"><path fill="currentColor" d="M13 3h2v6h-2zM3 21l7-7l4 4l-7 7H3zM20 4l1.4 1.4l-8.8 8.8L11.2 12z"/></symbol>
  <symbol id="ic-wrench" viewBox="0 0 24 24"><path fill="currentColor" d="M22 6.92a5.5 5.5 0 0 1-7.78 7.78L5 23H2v-3l8.3-9.22A5.5 5.5 0 0 1 17.08 2z"/></symbol>
  <symbol id="ic-audit" viewBox="0 0 24 24"><path fill="currentColor" d="M3 3h14v18H3zM7 7h6v2H7zm0 4h6v2H7zM21 7h-2v10h2z"/></symbol>
  <symbol id="ic-theme" viewBox="0 0 24 24"><path fill="currentColor" d="M12 3a9 9 0 1 0 9 9h-9z"/></symbol>
  <symbol id="ic-search" viewBox="0 0 24 24"><path fill="currentColor" d="M15.5 14h-.79l-.28-.27A6 6 0 1 0 9.5 15a6 6 0 0 0 3.73-1.31l.27.28v.79L20 20.5L21.5 19z"/></symbol>
</defs></svg>
</head>
<body data-theme="light">

<div class="layout">
  <!-- LEFT: MENU -->
  <aside class="sidebar" id="menu">
    <header>
      <div class="brand">
        <svg><use href="#ic-box"/></svg>
        <span>WMS Menu</span>
      </div>
      <button class="btn" id="themeBtn" title="Toggle light/dark">
        <svg style="width:18px;height:18px"><use href="#ic-theme"/></svg>
      </button>
    </header>

    <div class="search">
      <svg style="width:18px;height:18px;color:var(--muted)"><use href="#ic-search"/></svg>
      <input id="search" type="text" placeholder="Search menu… ( / )" autocomplete="off" />
      <span class="kbd">Esc</span>
    </div>

    <div class="quick" aria-label="Quick actions">
      <a class="chip" href="stock-quick-scan.php" data-link target="mainFrame"><svg><use href="#ic-scan"/></svg> Quick Scan</a>
      <a class="chip" href="batch_ship_out_scan.php" data-link target="mainFrame"><svg><use href="#ic-truck"/></svg> Ship Out</a>
      <a class="chip" href="batch_scan_inbound_or_return_shelf(all_condition).php" data-link target="mainFrame"><svg><use href="#ic-box"/></svg> Inbound/RMA</a>
    </div>

    <div class="groups">
      <details class="group" data-group="home" open>
        <summary><svg style="width:18px;height:18px"><use href="#ic-home"/></svg><span class="title">Home & Help</span></summary>
        <ul class="menu">
          <li><a href="wms-workspace.html" data-link target="mainFrame">WMS Instruction</a></li>
        </ul>
      </details>

      <details class="group" data-group="ops" open>
        <summary><svg style="width:18px;height:18px"><use href="#ic-scan"/></svg><span class="title">Operations</span></summary>
        <ul class="menu">
          <li><a href="stock-quick-scan.php" data-link target="mainFrame">Quick Product Scan</a></li>
          <li><a href="batch_ship_out_scan.php" data-link target="mainFrame">Ship Out Scan</a></li>
        </ul>
      </details>

      <details class="group" data-group="inventory" open>
        <summary><svg style="width:18px;height:18px"><use href="#ic-box"/></svg><span class="title">Inventory</span></summary>
        <ul class="menu">
          <li><a href="batch_inventory_reconcile_all_condition.php" data-link target="mainFrame">Inventory Reconcile</a></li>
          <li><a href="batch_scan_inbound_or_return_shelf(all_condition).php" data-link target="mainFrame">Inbound/RMA to Stock</a></li>
          <li><a href="add_to_shelf(all_condition).php" data-link target="mainFrame">Create Shelf Record</a></li>
          <li><a href="transfer_between_shelf.php" data-link target="mainFrame">Transfer to New Shelf</a></li>
          <li>
            <a href="#" aria-disabled="true" onClick="return false;"><svg style="width:16px;height:16px"><use href="#ic-broom"/></svg> Shelf Reset <small style="margin-left:auto;color:var(--muted)">submenu</small></a>
            <ul class="menu submenu">
              <li><a href="cleanup_shelf_record_all_condition.php" data-link target="mainFrame">Cleanup Shelf Record</a></li>
              <li><a href="init_shelf.php" data-link target="mainFrame">Initialize A Shelf</a></li>
            </ul>
          </li>
        </ul>
      </details>

      <details class="group" data-group="reconcile" open>
        <summary><svg style="width:18px;height:18px"><use href="#ic-audit"/></svg><span class="title">Reconcile & Audits</span></summary>
        <ul class="menu">
          <li><a href="post_fba_reconcile.php" data-link target="mainFrame">Post FBA Inventory Reconcile</a></li>
          <li><a href="check_inventory.php" data-link target="mainFrame">Warehouse Record Discrepancy</a></li>
        </ul>
      </details>

      <details class="group" data-group="maintenance">
        <summary><svg style="width:18px;height:18px"><use href="#ic-wrench"/></svg><span class="title">Maintenance</span></summary>
        <ul class="menu">
          <li><a href="warehouse_record_inpsection.php" data-link target="mainFrame">Review Warehouse Record</a></li>
          <li><a href="fix_product_on_multiple_shelf.php" data-link target="mainFrame">Combine Multiple Shelf</a></li>
          <li><a href="manual_update_shelf.php" data-link target="mainFrame">Manual Inventory Reconcile</a></li>
          <li><a href="seperate_shelf.php" data-link target="mainFrame">(temp) Separate Shelf</a></li>
        </ul>
      </details>
    </div>
  </aside>

  <!-- RIGHT: CONTENT -->
  <main class="content">
    <iframe id="mainFrame" name="mainFrame" src="wms-workspace.html" title="WMS Content"></iframe>
  </main>
</div>

<script>
(function(){
  const themeBtn = document.getElementById('themeBtn');
  const groups = document.querySelectorAll('details.group');
  const links = document.querySelectorAll('[data-link]');
  const iframe = document.getElementById('mainFrame');
  const search = document.getElementById('search');

  // Persist theme (default light)
  const themeKey = 'wmsTheme';
  const savedTheme = localStorage.getItem(themeKey);
  if(savedTheme){ document.body.setAttribute('data-theme', savedTheme) }
  themeBtn.addEventListener('click', ()=>{
    const now = document.body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
    document.body.setAttribute('data-theme', now);
    localStorage.setItem(themeKey, now);
  });

  // Persist open groups
  const openKey = 'wmsMenuOpenGroups';
  try{
    const state = JSON.parse(localStorage.getItem(openKey) || '{}');
    groups.forEach(g=>{
      const id = g.dataset.group;
      if(id in state) g.open = !!state[id];
      g.addEventListener('toggle', ()=>{
        const s = JSON.parse(localStorage.getItem(openKey) || '{}');
        s[id] = g.open; localStorage.setItem(openKey, JSON.stringify(s));
      });
    });
  }catch(e){}

  // Active link highlight + load into iframe + persist last page
  const activeKey = 'wmsMenuActiveHref';
  function applyActive(href){
    links.forEach(a=>a.removeAttribute('aria-current'));
    const active = Array.from(links).find(a => a.getAttribute('href') === href);
    if(active){ active.setAttribute('aria-current','page'); }
  }
  // Restore last page
  const lastHref = localStorage.getItem(activeKey);
  if(lastHref){
    iframe.src = lastHref;
    applyActive(lastHref);
  }

  links.forEach(a=>{
    a.addEventListener('click', (e)=>{
      // Allow ctrl/cmd middle-click to open in new tab
      if(e.metaKey || e.ctrlKey || e.button === 1) return;
      e.preventDefault();
      const href = a.getAttribute('href');
      iframe.src = href;
      localStorage.setItem(activeKey, href);
      applyActive(href);
    });
  });

  // Search / filter with highlight
  function clearMarks(el){
    el.querySelectorAll('mark').forEach(m=>{
      const t = document.createTextNode(m.textContent);
      m.replaceWith(t);
    });
  }
  function markMatch(el, q){
    const re = new RegExp(q.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'ig');
    for(const node of Array.from(el.childNodes)){
      if(node.nodeType === 3){
        const text = node.nodeValue;
        const frag = document.createDocumentFragment();
        let last = 0, m;
        while((m = re.exec(text)) !== null){
          if(m.index > last){ frag.appendChild(document.createTextNode(text.slice(last, m.index))); }
          const mark = document.createElement('mark');
          mark.textContent = m[0];
          frag.appendChild(mark);
          last = m.index + m[0].length;
        }
        frag.appendChild(document.createTextNode(text.slice(last)));
        if(frag.childNodes.length > 1){ node.replaceWith(frag); }
      }else if(node.nodeType === 1){
        markMatch(node, q);
      }
    }
  }
  function filterMenu(){
    const q = search.value.trim();
    const lc = q.toLowerCase();
    document.querySelectorAll('details.group').forEach(g=>{
      const items = g.querySelectorAll('.menu a[data-link]');
      let any = false;
      items.forEach(a=>{
        clearMarks(a);
        const txt = a.textContent.toLowerCase();
        const hit = !lc || txt.includes(lc);
        a.parentElement.style.display = hit ? '' : 'none';
        if(hit && lc){ markMatch(a, q); }
        any = any || hit;
      });
      g.style.display = any ? '' : 'none';
      if(lc && any) g.open = true;
    });
  }
  search.addEventListener('input', filterMenu);

  // Keyboard shortcuts
  document.addEventListener('keydown', (e)=>{
    if(e.key === '/' && document.activeElement !== search){
      e.preventDefault(); search.focus();
    }else if(e.key === 'Escape'){
      if(search.value){ search.value=''; filterMenu(); }
      search.blur();
    }
  });

  filterMenu();
})();
</script>
</body>
</html>
