<!--
åŠ ä¸Šä»¥ä¸‹åŠŸèƒ½
1 æœç´¢é«˜äº®å…³é”®è¯
2 æ·»åŠ æ–°ç”¨æˆ·æŒ‰é’®
3 æ•°æ®æŒä¹…åŒ–ï¼ˆlocalStorageï¼‰
4 æ”¯æŒä¸­æ–‡æ‹¼éŸ³æœç´¢ 

å¤–æ·»åŠ ä¸¤åˆ—ï¼šâ€œå…¬å¸â€å’Œâ€œç”Ÿæ—¥â€

Qwen3-235B-A22B-2507 4:12 pm

å¤ªå¥½äº†ï¼ä»¥ä¸‹æ˜¯åŠŸèƒ½å…¨é¢å¢å¼ºç‰ˆçš„ç½‘é¡µä»£ç ï¼ŒåŒ…å«ä½ è¦æ±‚çš„æ‰€æœ‰åŠŸèƒ½ï¼š 
 
âœ… æ–°å¢åŠŸèƒ½ä¸€è§ˆ 
ğŸ“Œæ–°å¢ä¸¤åˆ—		â€œå…¬å¸â€ å’Œ â€œç”Ÿæ—¥â€
ğŸ”æœç´¢é«˜äº®		æœç´¢å…³é”®è¯åœ¨è¡¨æ ¼ä¸­é«˜äº®æ˜¾ç¤ºï¼ˆé»„è‰²èƒŒæ™¯ï¼‰
â•æ·»åŠ ç”¨æˆ·æŒ‰é’®	ç‚¹å‡»å¼¹å‡ºè¡¨å•æ·»åŠ æ–°ç”¨æˆ·
ğŸ’¾æ•°æ®æŒä¹…åŒ–		ä½¿ç”¨localStorageä¿å­˜æ•°æ®ï¼Œåˆ·æ–°ä¸ä¸¢å¤±
ğŸ‡¨ğŸ‡³ä¸­æ–‡æ‹¼éŸ³æœç´¢	æ”¯æŒç”¨æ‹¼éŸ³æœç´¢ä¸­æ–‡å§“åï¼ˆå¦‚ï¼šzhangsanâ†’ åŒ¹é…â€œå¼ ä¸‰â€ï¼‰
  
 
âœ… å®Œæ•´ HTML + JS ä»£ç ï¼ˆå¤åˆ¶å³å¯è¿è¡Œï¼‰ 
-->

<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>é«˜çº§å¯ç¼–è¾‘è¡¨æ ¼</title>
  <!-- å¼•å…¥æ‹¼éŸ³åº“ï¼ˆç”¨äºä¸­æ–‡è½¬æ‹¼éŸ³ï¼‰ -->
  <!-- script src="https://cdn.jsdelivr.net/npm/pinyin-pro@2.20.0/dist/pinyin.min.js"></script -->
  <script src="https://cdn.jsdelivr.net/npm/pinyin@4.0.0/lib/umd/pinyin.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .search-container {
      flex-grow: 1;
      margin-right: 15px;
      max-width: 400px;
    }
    .search-container label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    #searchInput {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
    }
    #addUserBtn {
      padding: 10px 15px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: center;
    }
    th {
      background-color: #f4f4f4;
    }
    td {
      position: relative;
    }
    .highlight {
      background-color: yellow;
      padding: 2px;
      border-radius: 3px;
    }
    .action-btn {
      margin: 0 5px;
      padding: 5px 10px;
      cursor: pointer;
    }
    .edit-btn {
      background-color: #2196F3;
      color: white;
      border: none;
      border-radius: 3px;
    }
    .delete-btn {
      background-color: #f44336;
      color: white;
      border: none;
      border-radius: 3px;
    }
    dialog {
      border: 1px solid #ccc;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      padding: 20px;
      width: 500px;
    }
    dialog h2 {
      margin-top: 0;
    }
    .form-group {
      margin-bottom: 15px;
    }
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    .form-group input, .form-group select {
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .dialog-buttons {
      text-align: right;
      margin-top: 20px;
    }
    .dialog-buttons button {
      padding: 8px 15px;
      margin-left: 10px;
      cursor: pointer;
      border: none;
      border-radius: 4px;
    }
    .save-btn {
      background-color: #2196F3;
      color: white;
    }
    .cancel-btn {
      background-color: #9e9e9e;
      color: white;
    }
    .add-btn {
      background-color: #4CAF50;
      color: white;
    }
  </style>
</head>
<body>

<h2>ç”¨æˆ·ä¿¡æ¯ç®¡ç†</h2>

<div class="header">
  <div class="search-container">
    <label for="searchInput">æœç´¢å§“å/é‚®ç®±/å…¬å¸/æ‹¼éŸ³</label>
    <input type="text" id="searchInput" placeholder="è¾“å…¥å…³é”®å­—..." />
  </div>
  <button id="addUserBtn">â• æ·»åŠ ç”¨æˆ·</button>
</div>

<table id="dataTable">
  <thead>
    <tr>
      <th>ID</th>
      <th>å§“å</th>
      <th>é‚®ç®±</th>
      <th>å…¬å¸</th>
      <th>ç”Ÿæ—¥</th>
      <th>æ“ä½œ</th>
    </tr>
  </thead>
  <tbody id="tableBody">
    <!-- æ•°æ®ç”± JS æ¸²æŸ“ -->
  </tbody>
</table>

<!-- ç¼–è¾‘/æ·»åŠ å¯¹è¯æ¡† -->
<dialog id="editDialog">
  <h2 id="dialogTitle">ç¼–è¾‘ç”¨æˆ·</h2>
  <form id="editForm">
    <input type="hidden" id="edit-id" />
    <div class="form-group">
      <label for="edit-name">å§“å</label>
      <input type="text" id="edit-name" required />
    </div>
    <div class="form-group">
      <label for="edit-email">é‚®ç®±</label>
      <input type="email" id="edit-email" required />
    </div>
    <div class="form-group">
      <label for="edit-company">å…¬å¸</label>
      <input type="text" id="edit-company" required />
    </div>
    <div class="form-group">
      <label for="edit-birthday">ç”Ÿæ—¥</label>
      <input type="date" id="edit-birthday" required />
    </div>
    <div class="dialog-buttons">
      <button type="button" class="cancel-btn" id="cancelBtn">å–æ¶ˆ</button>
      <button type="submit" class="save-btn">ä¿å­˜</button>
    </div>
  </form>
</dialog>

<script>
  // ä» localStorage åŠ è½½æ•°æ®
  const loadData = () => {
    const saved = localStorage.getItem("tableData");
    return saved ? JSON.parse(saved) : [
      { id: 1, name: "å¼ ä¸‰", email: "zhangsan@example.com", company: "ç§‘æŠ€å…¬å¸", birthday: "1990-01-15" },
      { id: 2, name: "æå››", email: "lisi@company.com", company: "è®¾è®¡å·¥ä½œå®¤", birthday: "1985-03-22" },
      { id: 3, name: "ç‹äº”", email: "wangwu@gmail.com", company: "è°·æ­Œ", birthday: "1992-07-10" },
      { id: 4, name: "èµµå…­", email: "zhaoliu@hotmail.com", company: "å¾®è½¯", birthday: "1988-11-05" },
      { id: 5, name: "é™ˆä¸ƒ", email: "chenqi@outlook.com", company: "åˆåˆ›å…¬å¸", birthday: "1995-04-18" },
      { id: 6, name: "åˆ˜å…«", email: "liuba@tech.org", company: "TechCorp", birthday: "1991-09-30" },
      { id: 7, name: "å­™ä¹", email: "sunjiu@data.net", company: "æ•°æ®å…¬å¸", birthday: "1987-12-25" },
      { id: 8, name: "å‘¨å", email: "zhoushi@web.cn", company: "ç½‘ç»œå…¬å¸", birthday: "1993-06-14" },
      { id: 9, name: "å´å°æ˜", email: "wuxiaoming@abc.com", company: "ABCé›†å›¢", birthday: "1990-08-09" },
      { id: 10, name: "éƒ‘å¤§ä¼Ÿ", email: "zhengdawei@xyz.com", company: "XYZç§‘æŠ€", birthday: "1984-02-28" },
      { id: 11, name: "é»„ä¸½ä¸½", email: "huanglili@demo.com", company: "Demoå…¬å¸", birthday: "1996-05-12" },
      { id: 12, name: "å¾é£", email: "xufei@startup.io", company: "StartupLab", birthday: "1994-10-03" }
    ];
  };

  let tableData = loadData();
  let isAddingNew = false; // æ ‡è®°æ˜¯æ–°å¢è¿˜æ˜¯ç¼–è¾‘

  const tableBody = document.getElementById("tableBody");
  const searchInput = document.getElementById("searchInput");
  const dialog = document.getElementById("editDialog");
  const editForm = document.getElementById("editForm");
  const cancelBtn = document.getElementById("cancelBtn");
  const addUserBtn = document.getElementById("addUserBtn");
  const dialogTitle = document.getElementById("dialogTitle");

  // ä¿å­˜æ•°æ®åˆ° localStorage
  function saveData() {
    localStorage.setItem("tableData", JSON.stringify(tableData));
  }

  // é«˜äº®æ–‡æœ¬å‡½æ•°
  function highlightText(text, query) {
    if (!query) return text;
    const regex = new RegExp(`(${query})`, 'gi');
    return text.toString().replace(regex, '<span class="highlight">$1</span>');
  }

  // è·å–å§“åçš„æ‹¼éŸ³ï¼ˆç”¨äºæœç´¢ï¼‰
  async function getPinyin(name) {
    // pinyin-pro æ”¯æŒå¼‚æ­¥æ‹¼éŸ³è½¬æ¢
    try {
      return pinyin(name, { toneType: 'none', type: 'array' }).join(' ');
    } catch (e) {
      console.warn("æ‹¼éŸ³åº“æœªåŠ è½½å®Œæˆï¼Œä½¿ç”¨ fallback");
      return '';
    }
  }

  // æ¸²æŸ“è¡¨æ ¼ï¼ˆå¸¦é«˜äº®ï¼‰
  async function renderTable(dataToRender) {
    const query = searchInput.value.trim().toLowerCase();
    const pinyinMap = {};
    if (query && query.match(/^[a-z]+$/)) {
      // å¦‚æœæ˜¯çº¯å­—æ¯æœç´¢ï¼Œæ‰å°è¯•è½¬æ‹¼éŸ³åŒ¹é…
      for (const user of tableData) {
        pinyinMap[user.id] = (await getPinyin(user.name)).toLowerCase();
      }
    }

    tableBody.innerHTML = "";
    for (const user of dataToRender) {
      const tr = document.createElement("tr");

      let nameContent = user.name;
      let emailContent = user.email;
      let companyContent = user.company;

      // æ‹¼éŸ³åŒ¹é…é€»è¾‘
      const matchesPinyin = query && pinyinMap[user.id]?.includes(query);

      if (query && (matchesPinyin || user.name.toLowerCase().includes(query))) {
        nameContent = highlightText(user.name, query);
      }
      if (query && user.email.toLowerCase().includes(query)) {
        emailContent = highlightText(user.email, query);
      }
      if (query && user.company.toLowerCase().includes(query)) {
        companyContent = highlightText(user.company, query);
      }

      tr.innerHTML = `
        <td>${user.id}</td>
        <td>${nameContent}</td>
        <td>${emailContent}</td>
        <td>${companyContent}</td>
        <td>${user.birthday}</td>
        <td>
          <button class="action-btn edit-btn" data-id="${user.id}">Edit</button>
          <button class="action-btn delete-btn" data-id="${user.id}">Delete</button>
        </td>
      `;
      tableBody.appendChild(tr);
    }

    bindEvents();
  }

  // ç»‘å®šäº‹ä»¶
  function bindEvents() {
    document.querySelectorAll(".delete-btn").forEach(btn => {
      btn.addEventListener("click", function () {
        const id = parseInt(this.getAttribute("data-id"));
        tableData = tableData.filter(u => u.id !== id);
        saveData();
        applySearch();
      });
    });

    document.querySelectorAll(".edit-btn").forEach(btn => {
      btn.addEventListener("click", function () {
        const id = parseInt(this.getAttribute("data-id"));
        const user = tableData.find(u => u.id === id);
        if (user) {
          isAddingNew = false;
          dialogTitle.textContent = "ç¼–è¾‘ç”¨æˆ·";
          document.getElementById("edit-id").value = user.id;
          document.getElementById("edit-name").value = user.name;
          document.getElementById("edit-email").value = user.email;
          document.getElementById("edit-company").value = user.company;
          document.getElementById("edit-birthday").value = user.birthday;
          dialog.showModal();
        }
      });
    });
  }

  // å®æ—¶æœç´¢
  async function applySearch() {
    const query = searchInput.value.trim().toLowerCase();
    if (!query) {
      renderTable(tableData);
      return;
    }

    // è·å–æ‰€æœ‰ç”¨æˆ·çš„æ‹¼éŸ³
    const pinyinPromises = tableData.map(async user => {
      const pinyin = await getPinyin(user.name);
      return { id: user.id, pinyin: pinyin.toLowerCase() };
    });
    const pinyinResults = await Promise.all(pinyinPromises);
    const pinyinMap = pinyinResults.reduce((map, item) => {
      map[item.id] = item.pinyin;
      return map;
    }, {});

    const filtered = tableData.filter(user => {
      const pinyin = pinyinMap[user.id] || '';
      return (
        user.name.toLowerCase().includes(query) ||
        user.email.toLowerCase().includes(query) ||
        user.company.toLowerCase().includes(query) ||
        pinyin.includes(query)
      );
    });

    renderTable(filtered);
  }

  // ç›‘å¬æœç´¢
  searchInput.addEventListener("input", applySearch);

  // æ·»åŠ ç”¨æˆ·æŒ‰é’®
  addUserBtn.addEventListener("click", () => {
    isAddingNew = true;
    dialogTitle.textContent = "æ·»åŠ ç”¨æˆ·";
    editForm.reset();
    document.getElementById("edit-id").value = "";
    dialog.showModal();
  });

  // è¡¨å•æäº¤
  editForm.addEventListener("submit", async function (e) {
    e.preventDefault();
    const name = document.getElementById("edit-name").value.trim();
    const email = document.getElementById("edit-email").value.trim();
    const company = document.getElementById("edit-company").value.trim();
    const birthday = document.getElementById("edit-birthday").value;

    if (isAddingNew) {
      // æ·»åŠ æ–°ç”¨æˆ·
      const maxId = tableData.length > 0 ? Math.max(...tableData.map(u => u.id)) : 0;
      const newUser = {
        id: maxId + 1,
        name,
        email,
        company,
        birthday
      };
      tableData.push(newUser);
    } else {
      // ç¼–è¾‘ç°æœ‰ç”¨æˆ·
      const id = parseInt(document.getElementById("edit-id").value);
      const user = tableData.find(u => u.id === id);
      if (user) {
        user.name = name;
        user.email = email;
        user.company = company;
        user.birthday = birthday;
      }
    }

    saveData();
    dialog.close();
    applySearch(); // ä¿ç•™æœç´¢çŠ¶æ€
  });

  // å–æ¶ˆæŒ‰é’®
  cancelBtn.addEventListener("click", () => {
    dialog.close();
  });

  // åˆå§‹åŒ–
  (async () => {
    await applySearch(); // ç­‰å¾…æ‹¼éŸ³åº“åŠ è½½
  })();
</script>

</body>
</html>

<!--

âœ… ä½¿ç”¨è¯´æ˜ 
ğŸ” æœç´¢
	
è¾“å…¥zhang	â†’ åŒ¹é…â€œå¼ ä¸‰â€ï¼ˆæ‹¼éŸ³ï¼‰
è¾“å…¥ç§‘æŠ€		â†’ åŒ¹é…â€œç§‘æŠ€å…¬å¸â€ã€â€œXYZç§‘æŠ€â€

ğŸ¨ é«˜äº®
	
æ‰€æœ‰åŒ¹é…å­—æ®µè‡ªåŠ¨é»„è‰²é«˜äº®

â• æ·»åŠ ç”¨æˆ·

ç‚¹å‡»â€œæ·»åŠ ç”¨æˆ·â€æŒ‰é’®ï¼Œå¡«å†™è¡¨å•

ğŸ’¾ æŒä¹…åŒ–
	
åˆ·æ–°é¡µé¢æ•°æ®ä¸ä¸¢å¤±ï¼ˆå­˜å‚¨åœ¨localStorageï¼‰

ğŸ“… æ—¥æœŸé€‰æ‹©
	
ç”Ÿæ—¥ä½¿ç”¨åŸç”Ÿæ—¥æœŸé€‰æ‹©å™¨
 
 
 
ğŸ“¦ ä¾èµ–è¯´æ˜ 

  - ä½¿ç”¨äº† pinyin-pro  åº“å®ç°æ‹¼éŸ³æœç´¢
  - é€šè¿‡ CDN å¼•å…¥ï¼Œæ— éœ€ npm å®‰è£…
     

 
âœ… ç¤ºä¾‹æœç´¢æµ‹è¯• 
zhang		å¼ ä¸‰
wangwu		ç‹äº”
google		ä¸åŒ¹é…ï¼ˆä½†ä½ å¯ä»¥æ‰©å±•å…¬å¸æ‹¼éŸ³ï¼‰
å¾®è½¯			èµµå…­
@com		æ‰€æœ‰åŒ…å«@comçš„é‚®ç®±
åˆåˆ›			é™ˆä¸ƒ
 

éœ€è¦æˆ‘è¿›ä¸€æ­¥æ‰©å±•å—ï¼Ÿä¾‹å¦‚ï¼š 

  - å¯¼å‡ºä¸º CSV
  - åˆ†é¡µåŠŸèƒ½
  - å¤šå­—æ®µæ’åº
  - å…¬å¸åä¹Ÿæ”¯æŒæ‹¼éŸ³æœç´¢
  - å“åº”å¼é€‚é…æ‰‹æœº
     

æ¬¢è¿ç»§ç»­æå‡ºï¼ 

-->